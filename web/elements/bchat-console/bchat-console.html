<link rel="import" href="../../bower_components/polymer/polymer.html">

<dom-module id="bchat-console">

    <style>
        :host {
            display: block;
        }
    </style>

    <template>
        <more-route context name="thread" params="{{params}}"></more-route>

        <bchat-layout  page-title="Thread">

            <template id="msgList" is="dom-repeat" items="{{messages}}">
                <div>
                    <span>{{item.name}}</span>
                    <span>: </span>
                    <span>{{item.message}}</span>
                    <span>( </span>
                    <span>{{item.ordered}}</span>
                    <span>)</span>
                </div>
            </template>

            <p>

            <div>
                <input is="iron-input" bind-value="{{message}}" value="{{value::input}}">
                <button is="paper-icon-button" on-tap="sendMessage">Send</button>
            </div>
            <br>
            bind to <code>bind-value</code>: <span>[[message]]</span>
            <br>
            bind to <code>value::input</code>: <span>{{value}}</span>
            </p>

            <input is="iron-input" bind-value="{{first}}">
            <code>bind-value</code>: <span>{{first}}</span>


            <p>
                Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas lacus erat, commodo et facilisis et,
                imperdiet ut nulla. Pellentesque nec sapien turpis. Proin non arcu dapibus, gravida mauris vel, molestie
                felis. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce sollicitudin vitae massa eu
                semper. Etiam velit turpis, aliquam a urna in, volutpat sollicitudin elit. Donec blandit ex vulputate
                dignissim imperdiet. Integer semper, lorem et posuere molestie, dolor mauris condimentum leo, eu
                efficitur mauris mauris in velit. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur
                ridiculus mus. Praesent condimentum sem et est malesuada viverra. Suspendisse maximus mollis orci, nec
                dignissim ipsum ultrices vitae. Proin nec justo arcu. Curabitur ut suscipit eros.
            </p>

            <p>
                Nullam et ligula in mi fermentum dictum. Aenean ut condimentum purus. Mauris finibus porta quam, quis
                pulvinar tellus pellentesque vel. Mauris imperdiet, turpis vel aliquet ultrices, mauris augue varius
                eros, in lobortis massa lacus ac enim. In posuere mi libero, malesuada congue tellus congue ut. Ut
                congue volutpat augue. Cras eget lectus ullamcorper, euismod ipsum tincidunt, tempus nulla. Vivamus
                aliquet nulla et ipsum accumsan consectetur. Pellentesque vitae porta tellus. Suspendisse vel auctor
                purus. Proin aliquet auctor massa, id volutpat nisl tempor sed. Mauris sagittis facilisis lacus, ac
                gravida ante gravida sit amet.
            </p>

            <p>
                Ut sollicitudin, mauris luctus fermentum placerat, tortor risus elementum tortor, nec lacinia mauris dui
                vitae nunc. Nulla facilisi. Sed dapibus, ligula et feugiat commodo, sem quam tempus augue, vel
                condimentum quam dui et ligula. Praesent at erat id lectus finibus maximus in vel justo. Curabitur
                imperdiet, nunc non porta lobortis, felis est vestibulum ex, sit amet congue massa quam vel quam. Nulla
                accumsan diam ut ipsum congue hendrerit. Aliquam maximus nisl non diam interdum eleifend. Pellentesque
                consectetur quam eu quam scelerisque, ac volutpat turpis elementum. Proin rhoncus aliquet sapien et
                laoreet. In hac habitasse platea dictumst.
            </p>

            <p>
                Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas lacus erat, commodo et facilisis et,
                imperdiet ut nulla. Pellentesque nec sapien turpis. Proin non arcu dapibus, gravida mauris vel, molestie
                felis. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce sollicitudin vitae massa eu
                semper. Etiam velit turpis, aliquam a urna in, volutpat sollicitudin elit. Donec blandit ex vulputate
                dignissim imperdiet. Integer semper, lorem et posuere molestie, dolor mauris condimentum leo, eu
                efficitur mauris mauris in velit. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur
                ridiculus mus. Praesent condimentum sem et est malesuada viverra. Suspendisse maximus mollis orci, nec
                dignissim ipsum ultrices vitae. Proin nec justo arcu. Curabitur ut suscipit eros.
            </p>

            <p>
                Nullam et ligula in mi fermentum dictum. Aenean ut condimentum purus. Mauris finibus porta quam, quis
                pulvinar tellus pellentesque vel. Mauris imperdiet, turpis vel aliquet ultrices, mauris augue varius
                eros, in lobortis massa lacus ac enim. In posuere mi libero, malesuada congue tellus congue ut. Ut
                congue volutpat augue. Cras eget lectus ullamcorper, euismod ipsum tincidunt, tempus nulla. Vivamus
                aliquet nulla et ipsum accumsan consectetur. Pellentesque vitae porta tellus. Suspendisse vel auctor
                purus. Proin aliquet auctor massa, id volutpat nisl tempor sed. Mauris sagittis facilisis lacus, ac
                gravida ante gravida sit amet.
            </p>

            <p>
                Ut sollicitudin, mauris luctus fermentum placerat, tortor risus elementum tortor, nec lacinia mauris dui
                vitae nunc. Nulla facilisi. Sed dapibus, ligula et feugiat commodo, sem quam tempus augue, vel
                condimentum quam dui et ligula. Praesent at erat id lectus finibus maximus in vel justo. Curabitur
                imperdiet, nunc non porta lobortis, felis est vestibulum ex, sit amet congue massa quam vel quam. Nulla
                accumsan diam ut ipsum congue hendrerit. Aliquam maximus nisl non diam interdum eleifend. Pellentesque
                consectetur quam eu quam scelerisque, ac volutpat turpis elementum. Proin rhoncus aliquet sapien et
                laoreet. In hac habitasse platea dictumst.
            </p>
            <p>
                Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas lacus erat, commodo et facilisis et,
                imperdiet ut nulla. Pellentesque nec sapien turpis. Proin non arcu dapibus, gravida mauris vel, molestie
                felis. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce sollicitudin vitae massa eu
                semper. Etiam velit turpis, aliquam a urna in, volutpat sollicitudin elit. Donec blandit ex vulputate
                dignissim imperdiet. Integer semper, lorem et posuere molestie, dolor mauris condimentum leo, eu
                efficitur mauris mauris in velit. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur
                ridiculus mus. Praesent condimentum sem et est malesuada viverra. Suspendisse maximus mollis orci, nec
                dignissim ipsum ultrices vitae. Proin nec justo arcu. Curabitur ut suscipit eros.
            </p>

            <p>
                Nullam et ligula in mi fermentum dictum. Aenean ut condimentum purus. Mauris finibus porta quam, quis
                pulvinar tellus pellentesque vel. Mauris imperdiet, turpis vel aliquet ultrices, mauris augue varius
                eros, in lobortis massa lacus ac enim. In posuere mi libero, malesuada congue tellus congue ut. Ut
                congue volutpat augue. Cras eget lectus ullamcorper, euismod ipsum tincidunt, tempus nulla. Vivamus
                aliquet nulla et ipsum accumsan consectetur. Pellentesque vitae porta tellus. Suspendisse vel auctor
                purus. Proin aliquet auctor massa, id volutpat nisl tempor sed. Mauris sagittis facilisis lacus, ac
                gravida ante gravida sit amet.
            </p>

            <p>
                Ut sollicitudin, mauris luctus fermentum placerat, tortor risus elementum tortor, nec lacinia mauris dui
                vitae nunc. Nulla facilisi. Sed dapibus, ligula et feugiat commodo, sem quam tempus augue, vel
                condimentum quam dui et ligula. Praesent at erat id lectus finibus maximus in vel justo. Curabitur
                imperdiet, nunc non porta lobortis, felis est vestibulum ex, sit amet congue massa quam vel quam. Nulla
                accumsan diam ut ipsum congue hendrerit. Aliquam maximus nisl non diam interdum eleifend. Pellentesque
                consectetur quam eu quam scelerisque, ac volutpat turpis elementum. Proin rhoncus aliquet sapien et
                laoreet. In hac habitasse platea dictumst.
            </p>
            <p>
                Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas lacus erat, commodo et facilisis et,
                imperdiet ut nulla. Pellentesque nec sapien turpis. Proin non arcu dapibus, gravida mauris vel, molestie
                felis. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce sollicitudin vitae massa eu
                semper. Etiam velit turpis, aliquam a urna in, volutpat sollicitudin elit. Donec blandit ex vulputate
                dignissim imperdiet. Integer semper, lorem et posuere molestie, dolor mauris condimentum leo, eu
                efficitur mauris mauris in velit. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur
                ridiculus mus. Praesent condimentum sem et est malesuada viverra. Suspendisse maximus mollis orci, nec
                dignissim ipsum ultrices vitae. Proin nec justo arcu. Curabitur ut suscipit eros.
            </p>

            <p>
                Nullam et ligula in mi fermentum dictum. Aenean ut condimentum purus. Mauris finibus porta quam, quis
                pulvinar tellus pellentesque vel. Mauris imperdiet, turpis vel aliquet ultrices, mauris augue varius
                eros, in lobortis massa lacus ac enim. In posuere mi libero, malesuada congue tellus congue ut. Ut
                congue volutpat augue. Cras eget lectus ullamcorper, euismod ipsum tincidunt, tempus nulla. Vivamus
                aliquet nulla et ipsum accumsan consectetur. Pellentesque vitae porta tellus. Suspendisse vel auctor
                purus. Proin aliquet auctor massa, id volutpat nisl tempor sed. Mauris sagittis facilisis lacus, ac
                gravida ante gravida sit amet.
            </p>

            <p>
                Ut sollicitudin, mauris luctus fermentum placerat, tortor risus elementum tortor, nec lacinia mauris dui
                vitae nunc. Nulla facilisi. Sed dapibus, ligula et feugiat commodo, sem quam tempus augue, vel
                condimentum quam dui et ligula. Praesent at erat id lectus finibus maximus in vel justo. Curabitur
                imperdiet, nunc non porta lobortis, felis est vestibulum ex, sit amet congue massa quam vel quam. Nulla
                accumsan diam ut ipsum congue hendrerit. Aliquam maximus nisl non diam interdum eleifend. Pellentesque
                consectetur quam eu quam scelerisque, ac volutpat turpis elementum. Proin rhoncus aliquet sapien et
                laoreet. In hac habitasse platea dictumst.
            </p>
            <p>
                Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas lacus erat, commodo et facilisis et,
                imperdiet ut nulla. Pellentesque nec sapien turpis. Proin non arcu dapibus, gravida mauris vel, molestie
                felis. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce sollicitudin vitae massa eu
                semper. Etiam velit turpis, aliquam a urna in, volutpat sollicitudin elit. Donec blandit ex vulputate
                dignissim imperdiet. Integer semper, lorem et posuere molestie, dolor mauris condimentum leo, eu
                efficitur mauris mauris in velit. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur
                ridiculus mus. Praesent condimentum sem et est malesuada viverra. Suspendisse maximus mollis orci, nec
                dignissim ipsum ultrices vitae. Proin nec justo arcu. Curabitur ut suscipit eros.
            </p>

            <p>
                Nullam et ligula in mi fermentum dictum. Aenean ut condimentum purus. Mauris finibus porta quam, quis
                pulvinar tellus pellentesque vel. Mauris imperdiet, turpis vel aliquet ultrices, mauris augue varius
                eros, in lobortis massa lacus ac enim. In posuere mi libero, malesuada congue tellus congue ut. Ut
                congue volutpat augue. Cras eget lectus ullamcorper, euismod ipsum tincidunt, tempus nulla. Vivamus
                aliquet nulla et ipsum accumsan consectetur. Pellentesque vitae porta tellus. Suspendisse vel auctor
                purus. Proin aliquet auctor massa, id volutpat nisl tempor sed. Mauris sagittis facilisis lacus, ac
                gravida ante gravida sit amet.
            </p>

            <p>
                Ut sollicitudin, mauris luctus fermentum placerat, tortor risus elementum tortor, nec lacinia mauris dui
                vitae nunc. Nulla facilisi. Sed dapibus, ligula et feugiat commodo, sem quam tempus augue, vel
                condimentum quam dui et ligula. Praesent at erat id lectus finibus maximus in vel justo. Curabitur
                imperdiet, nunc non porta lobortis, felis est vestibulum ex, sit amet congue massa quam vel quam. Nulla
                accumsan diam ut ipsum congue hendrerit. Aliquam maximus nisl non diam interdum eleifend. Pellentesque
                consectetur quam eu quam scelerisque, ac volutpat turpis elementum. Proin rhoncus aliquet sapien et
                laoreet. In hac habitasse platea dictumst.
            </p>
        </bchat-layout>
    </template>

</dom-module>

<script>
    Polymer({
        is: 'bchat-console',

        lastRecieveMsg: undefined,
        lastSendMsg: undefined,

        properties: {
            first: String,
            last: String,

            messages: {
                type: Array,
                notify: true,
                value: [
                    {name: 'Bob', message: 'Hello Alice', ordered: 0},
                    {name: 'Alice', message: 'Hi Bob!!!', ordered: 0}
                ]
            }
        },
        observers: ['usersAddedOrRemoved(messages.splices)'],
        sendMessage: function (event, data) {
            var sendMsg = {name: 'me', message: this.message, ordered: 0};
            //   this.messages.push(sendMsg);
            this.push('messages', sendMsg);
            console.log('add msg', sendMsg);
            console.dir(this.messages);
            this.lastSendMsg = sendMsg;
            this.message = '';
        },
        order: function (e) {
            var model = e.model;
            model.set('item.ordered', model.item.ordered + 1);
        },
        usersAddedOrRemoved: function (changeRecord) {
            if (!changeRecord) {
                return;
            }
            changeRecord.indexSplices.forEach(function (s) {
                s.removed.forEach(function (user) {
                    console.log(user.name + ' was  removed');
                });
                console.log(s.addedCount + ' users  were added');
            }, this);
        }

    })
    ;
</script>
